# 矩阵的广义逆（一）：定义和基本性质

**本文内容：**

- 广义逆的定义
  - 定义
  - 存在性、唯一性以及表达式

- 广义逆的基本性质

**需要的前置知识：**

- Hermite转置，$A^H$，即$A$的**共轭转置**，就是对 $A^T$ 的每一个元素再求共轭。在 $A$ 是实矩阵时就是 $A^T$ 。**Hermite矩阵**是指满足 $A^H=A$ 的矩阵，在 $A$ 是实矩阵时就是指实对称矩阵）

- 奇异值分解/SVM。对于任何一个矩阵 $A\in \mathbb{C}^{m\times n}$，都存在矩阵 $U\in \mathbb{C}^{m\times m},S_r\in \mathbb{R}^{r\times r},V\in \mathbb{C}^{n\times n}$，使得
  $$
  A =U
  \left(\begin{array}{ll}
  S_r & 0 \\
  0 & 0
  \end{array}\right)_{m\times n}
  V^{-1}
  $$
  其中 $r=$ rank$(A)$；  $S_r$ 是对角矩阵，其对角元均为正实数，称为 $A$ 的 $r$ 个正奇异值； $U,V$ 满足 $U^{-1}=U^{H}, V^{-1}=V^{H}$。当 $A$ 是实矩阵时 $U,V$ 也为实矩阵。



## 矩阵广义逆的定义

**Def.** 设 $A\in \mathbb{C}^{m\times n}$，若矩阵 $X\in \mathbb{C}^{n\times m}$ 满足4个Moore-Penrose方程：

> (1) $AXA=A$
>
> (2) $XAX=X$
>
> (3) $(AX)^H=AX$
>
> (4) $(XA)^H = XA$

的全部或一部分，则称 $X$ 为 $A$ 的**广义逆**矩阵。

具体而言，若 $X$ 满足方程(i)，则记 $X=A^{(i)}$，全体 $A^{(i)}$ 的集合记作 $A\{i\}$。同理，定义 $A^{(i,j)},A^{(i,j,k)},A^{(1,2,3,4)},A\{i,j\},A\{i,j,k\},A\{1,2,3,4\}$。其中 $A^{(1)}$ 也记作 $A^-$， $A^{(1,2,3,4)}$ 也记作 $A^+$。



由以上定义可以看出，一个矩阵一共有$2^4-1=15$种广义逆。不过，比较常(you)见(yong)的广义逆一般都需要满足方程(1)，一个简单的理解方式是 $0 \in A\{2,3,4\}$，这说明若没有方程(1)的存在，则零矩阵是任何矩阵的广义逆，所以我们很难得到许多有意义的结果。

另外一个观察是：如果 $A$ 可逆，那么 $A^{-1}=A^+$。（直接验证$A^{-1}$满足方程(1)-(4)即可）这说明矩阵广义逆的确是矩阵逆的推广。

### $A^+$的存在唯一性

有了广义逆的定义之后，第一个问题就应该是——矩阵的各类广义逆是否存在？这个答案是肯定的。而且，对于满足全部MP方程的 $A^+$ ，它不仅存在，而且唯一。

**Thm 1.**  $\forall A\in \mathbb{C}^{m\times n}$， $A^+$ 存在且唯一。

*proof:* （存在性）对 $A$ 做奇异值分解
$$
A=U
\left(\begin{array}{ll}
S_r & 0 \\
0 & 0
\end{array}\right)
V^{-1}
$$
则令
$$
X=V
\left(\begin{array}{ll}
S_r^{-1} & 0 \\
0 & 0
\end{array}\right)
U^{-1}
$$
验证方程(1)-(4)即可知 $X=A^+$。

（唯一性）反复利用方程(1)-(4)可得：
$$
\begin{array}{l}
X \stackrel{(2)}{=} X A X \stackrel{(3)}{=} X(A X)^{H}=X X^{H} A^{H} \\
\quad \stackrel{({1})}{=} X X^{H}(A Y A)^{H}=X X^{H} A^{H} Y^{H} A^{H}=X(A X)^{H}(A Y)^{H}\stackrel{(3)}{=} X A X AY \stackrel{(2)}{=} XAY
\end{array}
$$
通过“左右颠倒”的操作可得：
$$
\begin{array}{l}
Y \stackrel{(2)}{=} Y A Y \stackrel{(4)}{=}(Y A)^{H} Y=A^{H} Y^{H} Y \\
\stackrel{\text { (1) }}{=}(A X A)^{H} Y^{H} Y=A^{H} X^{H} A^{H} Y^{H} Y=(X A)^{H}(Y A)^{H} Y \\
\quad  \stackrel{(4)}{=} X A Y A Y \stackrel{\text { (2) }}{=} X A Y
\end{array}
$$
所以 $X=Y$，即 $A^+$ 唯一。 $\square.$

以上证明的正确性毋庸置疑。但美中不足在于“不好想”：为什么能够直接设出 $A^+$ 的表达式，又是如何想到后面眼花缭乱的等式变形的呢？秉承*追求简单粗暴，拒绝花里胡哨*的理念，我决定给出另一个证明。思路是简单地使用奇异值分解后根据4个MP方程直接计算求解。使用SVM是因为SVM可以把一个复杂的任意矩阵 $A$ 转变为简单的可逆对角阵 $S_r$ 从而简化计算。

**Thm $1^\prime$.**  $\forall K\in \mathbb{C}^{m\times n}$，若 $K$ 的奇异值分解为
$$
K=U
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
V^{-1}
$$
则
$$
K^+=V
\left(\begin{array}{ll}
S_r^{-1} &  \\
 & 0
\end{array}\right)
U^{-1}
$$
存在且唯一。

*proof:* 我们假设
$$
V^{-1} K^+ U= X =
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
$$
由于 $U,V$ 可逆，故
$$
K^+=V
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
U^{-1}
$$
接下来只需求出 $X$ 。我们将上式代入方程(1)，得：
$$
KK^+K=
U
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
V^{-1}
=
U
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
V^{-1}
=K
$$

$$
\Longleftrightarrow \qquad
\left(\begin{array}{ll}
S_r & 0 \\
0 & 0
\end{array}\right)
=
\left(\begin{array}{ll}
S_rAS_r & 0 \\
0 & 0
\end{array}\right)
$$

即 $A=S_r^{-1}$，$B,C,D$ 任取。

同理，代入方程(2)，得：
$$
K^+KK^+=
V

\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
U^{-1}
=
V
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
U^{-1}
=K^+
$$

$$
\Longleftrightarrow \qquad
\left(\begin{array}{ll}
AS_rA & AS_rB \\
CS_rA & CS_rB
\end{array}\right)
=
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
$$

同理，代入方程(3)，得：
$$
(KK^+)^H=
U
\left(\begin{array}{ll}
A^H & C^H \\
B^H & D^H
\end{array}\right)
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
U^{H}
=
U
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
U^{-1}
=KK^+
$$

$$
\Longleftrightarrow \qquad
\left(\begin{array}{ll}
A^HS_r & 0 \\
B^HS_r & 0
\end{array}\right)
=
\left(\begin{array}{ll}
S_rA & S_rB \\
0 & 0
\end{array}\right)
$$

即 $A^HS_r=S_rA,\ B=0$，$C,D$ 任取。

同理，代入方程(4)，得：
$$
(K^+K)^H=
V
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
\left(\begin{array}{ll}
A^H & C^H \\
B^H & D^H
\end{array}\right)
V^{H}
=
V
\left(\begin{array}{ll}
A & B \\
C & D
\end{array}\right)
\left(\begin{array}{ll}
S_r &  \\
 & 0
\end{array}\right)
V^{-1}
=K^+K
$$

$$
\Longleftrightarrow \qquad
\left(\begin{array}{ll}
S_rA^H & S_rC^H \\
0 & 0
\end{array}\right)
=
\left(\begin{array}{ll}
AS_r & 0 \\
CS_r & 0
\end{array}\right)
$$

即 $S_rA^H=AS_r,\ C=0$，$B,D$ 任取。

综上，由方程(1)知 $A=S_r^{-1}$，由方程(3)知 $B=0$，由方程(4)知 $C=0$，由方程(2)知 $D=CS_rB=0$。

即满足方程(1)(2)(3)(4)的解为且仅为
$$
K^+=V
\left(\begin{array}{ll}
S_r^{-1} & 0 \\
0 & 0
\end{array}\right)
U^{-1}
$$
这就同时证明了存在性和唯一性。$\square.$



事实上，通过这个“笨”方法，我们能得到更多的结论，精确得出各类广义逆的通式：
$$
\begin{align}
K\{1\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & B \\
C & D
\end{array}\right)
U^{-1}\
\bigg\vert\ 
B\in\mathbb{C}^{r\times (m-r)},C\in\mathbb{C}^{(n-r)\times r},D\in\mathbb{C}^{(n-r)\times (m-r)}
\right\}
\\
\\K\{1,2\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & B \\
C & D
\end{array}\right)
U^{-1}\
\bigg\vert\ 
CS_rB=D
\right\}

\\K\{1,3\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & 0 \\
C & D
\end{array}\right)
U^{-1}\
\bigg\vert\ 
C\in\mathbb{C}^{(n-r)\times r},D\in\mathbb{C}^{(n-r)\times (m-r)}
\right\}

\\K\{1,4\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & B \\
0 & D
\end{array}\right)
U^{-1}\
\bigg\vert\ 
B\in\mathbb{C}^{r\times (m-r)},D\in\mathbb{C}^{(n-r)\times (m-r)}
\right\}
\\
\\K\{1,2,3\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & 0 \\
C & 0
\end{array}\right)
U^{-1}\
\bigg\vert\ 
C\in\mathbb{C}^{(n-r)\times r}
\right\}

\\K\{1,2,4\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & B \\
0 & 0
\end{array}\right)
U^{-1}\
\bigg\vert\ 
B\in\mathbb{C}^{r\times (m-r)}
\right\}

\\K\{1,3,4\}&=\left\{V
\left(\begin{array}{ll}
S_r^{-1} & 0 \\
0 & D
\end{array}\right)
U^{-1}\
\bigg\vert\ 
D\in\mathbb{C}^{(n-r)\times (m-r)}
\right\}
\end{align}
$$



## 广义逆的基本性质

**Prop.** 

1. $(A^+)^+=A$

2. $(A^H)^+=(A^+)^H,\quad (A^T)^+=(A^+)^T$

3. $A^+A, AA^+$ 均为幂等的Hermite矩阵

4. rank($A$) = rank($A^+$) 

5. $(A^HA)^+ = A^+ (A^H)^+,\quad (AA^H)^+ =  (A^H)^+ A^+$

6. $A^+ = (A^HA)^+ A^H = A^H (AA^H)^+$

7. Im($A^+$) $=$ Im($A^H$) ，Ker($A^+$) $=$ Ker($A^H$) 


证明我懒得详细写了，在我们既有4个MP方程，又知道 $A^+$ 的具体表达式的情况下，验证正确性没有太大难度，可以当做练习。提示一下，性质1、2、4观察方程(1)-(4)或者直接看 $A^+$ 具体表达式都可以得到；性质3验证一下显然；性质5、6代入4个MP方程验证即可，剩下的就是计算能力了；性质7利用方程(1)(2)和像与核的维数公式。

比起计算为主的证明，我觉得理解与记忆更重要，特别是看上去很奇怪的性质5和6。性质5的意思就是$A$和$A^H$相乘时求加号逆可以像求一般逆一样满足逆向分配律（这个律叫什么名字我不记得了……），注意这一点对一般的两个矩阵是未必成立的，$(AB)^+ \ne B^+A^+$ 。性质6其实就是当A存在左/右侧逆时，对单侧逆计算公式的推广。

