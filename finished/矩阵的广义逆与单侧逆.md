# 番外：矩阵的广义逆与单侧逆

**写在前面：**“单侧逆作为矩阵逆的推广，某种程度上也该称为一种“广义”逆。所以它究竟与真正的广义逆之间有什么关系呢？不可能没有关系的吧……”某天的我这么想到。于是我就着这个点想了想，还真发现了一些有意思的小结论。虽然貌似没什么直接应用，但也算是对二者概念和性质的理解更加“深刻”了一丢丢吧~（结尾甚至有主题升华！）

**本文结构：**

1. 介绍矩阵的广义逆
2. 介绍矩阵的单侧逆
3. 说明二者的关系

## 矩阵的广义逆

**Def.** 设 $A\in \mathbb{C}^{m\times n}$，若矩阵 $X\in \mathbb{C}^{n\times m}$ 满足4个Moore-Penrose方程：

> (1) $AXA=A$
>
> (2) $XAX=X$
>
> (3) $(AX)^H=AX$
>
> (4) $(XA)^H = XA$

的全部或一部分，则称 $X$ 为 $A$ 的**广义逆**矩阵。

具体而言，若 $X$ 满足方程(i)，则记 $X=A^{(i)}$，全体 $A^{(i)}$ 的集合记作 $A\{i\}$。同理，定义 $A^{(i,j)},A^{(i,j,k)},A^{(1,2,3,4)},A\{i,j\},A\{i,j,k\},A\{1,2,3,4\}$。其中 $A^{(1)}$ 也记作 $A^-$， $A^{(1,2,3,4)}$ 也记作 $A^+$。

更详细的对各类广义逆的介绍可以看我的这篇文章，我在说明二者关系时也用到了里面提到的一些结论。link

## 矩阵的单侧逆

**Def.** 若 $BA=I$，则称 $B$ 为 $A$ 的一个**左逆**（ $A$ 为 $B$ 的一个**右逆**）。

左逆和右逆具有很相似的性质，我们统称为**单侧逆**。首先，不同于广义逆，单侧逆作为矩阵逆的推广，它并不是一定存在的。事实上我们有如下刻画：

**Thm 1.** 以下命题等价：

1. $A$ 有左逆；
2. Ker($A$) = {0};
3. $A$ 列满秩

>*proof:* "1.$\implies$2." $\forall x \in$ Ker($A$)，有 $Ax=0$。设 $B$ 为 $A$ 的一个左逆，则有 $x = Ix = BAx=B0=0$。所以Ker($A$) = {0}。
>
>"2.$\implies$3." 设 $A$ 的各列为$\{a_1, a_2,\cdots,a_n\}$，$A$ 列满秩即 $\{a_1, a_2,\cdots,a_n\}$ 线性无关。
>
>那么我们假设 $\{ \lambda_i \}_{i=1}^n$ 使得 $\sum_{i=1}^n \lambda_i a_i=0$，而
>$$
>0 = \sum_{i=1}^n \lambda_i a_i 
>= (a_1,\cdots,a_n) 
>\begin{pmatrix}
>\lambda_1 \\
>\vdots \\
>\lambda_n \\
>\end{pmatrix}
>= A
>\begin{pmatrix}
>\lambda_1 \\
>\vdots \\
>\lambda_n \\
>\end{pmatrix}
>$$
>即 $(\lambda_1,\cdots,\lambda_n)^T \in$ Ker($A$)，故 $\lambda_1=\cdots=\lambda_n=0$，即 $\{a_1, a_2,\cdots,a_n\}$ 线性无关。
>
>"3.$\implies$1." 如果 $A$ 列满秩，则 $A^HA$ 可逆。那么 $B=(A^HA)^{-1}A^H$ 就是 $A$ 的一个左逆。$\square.$

同理，对称地，我们也有

**Thm 2.** 以下命题等价：

1. $A$ 有右逆；
2. Im($A$) = $\mathbb{R}^n$;
3. $A$ 行满秩

除了存在性没有保证外，单侧逆也是未必唯一的。**事实上，除非矩阵 $A$ 可逆，不然 $A$ 要么没有单侧逆，要么有无穷多个单侧逆。**这一点是不是和线性方程组的解的结构很像？其实道理也是类似的。以右逆为例，如果 $AB=I$，那么对于任意矩阵 $C$ 满足 $AC=0_{n\times n}$，不难看出 $B+C$ 都是 $A$ 的右逆。而在A行满秩却又不可逆时，$AC=0_{n\times n}$ 有无穷多解。

## 广义逆与单侧逆的关系

基本介绍结束了。关于二者的关系，接下来就让我还原一下我的思(xia)考(xiang)过程。为了方便我们分别记矩阵全体左逆的集合和全体右逆的集合为 $A_L^{-1},A_R^{-1}$。

**Step1.** 首先，我验证了一下单侧逆满足哪些M-P方程。容易验证的是，如果左/右逆存在，那么左逆满足方程(1)(2)(4)，右逆满足方程(1)(2)(3)，即：
$$
A_L^{-1} \subseteq A\{1,2,4\} \\
A_R^{-1} \subseteq A\{1,2,3\}
$$
**Step2.** 这是一个很好的开始！有了“上界”，那么紧接着我就考虑了一下“下界”。没有上面那么明显，不过我仍然成功地发现加号逆 $A^+$ 一定是矩阵的一个左逆/右逆，如果左/右逆存在的话。即：
$$
A_L^{-1} \supseteq A\{1,2,3,4\} \\
A_R^{-1} \supseteq A\{1,2,3,4\}
$$
>这是因为 $AA^+$ 和 $A^+A$ 都是秩与 $A$ 相等的幂等Hermite矩阵。因为幂等矩阵的特征值只有0和1，Hermite矩阵一定可以对角化，故二者都可写作
>$$
>P
>\begin{pmatrix}
>I_r & 0 \\
>0 & O_{n-r}
>\end{pmatrix}
>P^{-1}
>$$
>的形式。这时如果矩阵有左逆/右逆，那么 $A^+A$ 或 $AA^+$ 就一定是满秩的（类似 $A^HA$ 与  $AA^H$ 的情况）。故 $A^+A$ 或 $AA^+$ 可写作
>$$
>P I_n P^{-1} = I
>$$
>说明此时 $A^+$ 一定是矩阵的一个左逆/右逆。

综上，
$$
A\{1,2,3,4\} \subseteq A_L^{-1} \subseteq A\{1,2,4\} \\
A\{1,2,3,4\} \subseteq A_R^{-1} \subseteq A\{1,2,3\}
$$
**Step3.** 进展很不错嘛！有了上面这个看起来很赏心悦目的范围作为感性认识后，接下来我就想动真格的了，准备用我的大杀器——之前推导的精准表达式，去看看一个广义逆 $A^{(1,2,4)}$ 如果是左逆，需要满足什么条件（右逆同理）。这时我惊讶地发现：如果一个矩阵 $K$ 有右逆，那么它是行满秩的，那么它的SVM
$$
K=U
\left(\begin{array}{ll}
S_r & 0 \\
0 & 0
\end{array}\right)
V^{-1}
$$
中下面两块不存在，即
$$
K=U
\left(\begin{array}{ll}
S_r & 0 \\

\end{array}\right)
V^{-1}
$$
此时 $K$ 的广义逆的SVM就会形如
$$
V
\left(\begin{array}{ll}
A  \\
C 
\end{array}\right)
U^{-1}
$$
即一般情况下的 $B,D$ 两块子矩阵不存在。这时候我对比各类广义逆的等价条件，竟然发现 $K\{1,2,4\} = K\{ 1 \}$！同理，当 $K$ 有左逆时 $K\{1,2,3\} = K\{ 1 \}$。也就是说结论现在变成了：
$$
A\{1,2,3,4\} \subseteq A_L^{-1} \subseteq A\{1,2,4\} = A\{1\} \\
A\{1,2,3,4\} \subseteq A_R^{-1} \subseteq A\{1,2,3\} = A\{1\}
$$
此时的我已经隐隐感受到了真相：莫非 $A_L^{-1} = A\{1\}$？难道我们竟然只需要一个方程 $AXA=A$ 便足以表达单侧逆了吗？这个猜想一旦进入了我的脑海，那剩下验证的过程就已经十分简单了……

>$$
>X \in A\{1\} \iff AXA=A \iff AXA-A=0
>$$
>
>如果 $A$ 有左逆，那么
>$$
>AXA-A = A(XA-I) = 0
>$$
>两边左乘 $A$ 的一个左逆即得
>$$
>XA=I
>$$
>X就是A的一个左逆。
>
>同理，如果 $A$ 有右逆，那么
>$$
>AXA-A = (AX-I)A = 0
>$$
>两边左乘 $A$ 的一个右逆即得
>$$
>AX=I
>$$
>X就是A的一个右逆。$\square.$

上面这个证明，简单短小优美，除了定义之外完全不需要使用其他一丁点多余的性质和推论。它同时说明了两件事：

1. **广义逆完全包含了单侧逆。**在单侧逆存在时，我们有最终结论：
   $$
   A_L^{-1} = A\{1,2,4\} = A\{1\} \\
   A_R^{-1} = A\{1,2,3\} = A\{1\}
   $$

2. 单侧逆的存在性可以暗示广义逆集合间的特殊关系：

   **在左（右）逆存在时**，$A\{1,2,4\}$（$A\{1,2,3\}$），$A\{1\}$ 以及介于二者之间的集合们的包含关系全部变为相等关系。也就是说，**满足方程 $AXA=A$ 的广义逆只有 $A\{1\}$ 和 $A\{1,2,3,4\}$ 两种**（普通的减号逆兼单侧逆 $A^-$ 和特殊的加号逆 $A^+$）。

完爆我之前兜的一堆圈子。

现在想来，原来方程 $AXA=A$ 就已经同时集成了两种单侧逆的含义。这是我一开始没有想到的。某种程度上，我这一个兜大圈子的思考过程也说明了一个老生常谈的道理：发现好的命题时常比给出证明更有意义……

完结撒花。
